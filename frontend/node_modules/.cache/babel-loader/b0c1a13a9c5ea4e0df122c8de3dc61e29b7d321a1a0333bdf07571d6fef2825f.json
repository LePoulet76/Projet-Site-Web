{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\poula\\\\Desktop\\\\Projet-Site-Web-main\\\\Projet-Site-Web-main\\\\frontend\\\\src\\\\components\\\\Waveform.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Waveform = ({\n  audioUrl,\n  isPlaying\n}) => {\n  _s();\n  const containerRef = useRef(null);\n  const waveSurferRef = useRef(null);\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    if (!containerRef.current || !audioUrl) return;\n    setIsReady(false);\n    containerRef.current.innerHTML = \"\";\n    let isCancelled = false;\n\n    // Destroy any existing instance before creating a new one\n    if (waveSurferRef.current) {\n      waveSurferRef.current.destroy();\n    }\n\n    // Create new instance\n    const ws = WaveSurfer.create({\n      container: containerRef.current,\n      waveColor: \"violet\",\n      progressColor: \"#9013FE\",\n      cursorColor: \"#fff\",\n      barWidth: 6,\n      barRadius: 3,\n      height: 120,\n      responsive: true,\n      hideScrollbar: true,\n      backend: 'MediaElement'\n    });\n    waveSurferRef.current = ws;\n    ws.on(\"ready\", async () => {\n      if (isCancelled) return;\n      setIsReady(true);\n    });\n    ws.on(\"error\", err => {\n      console.warn(\"WaveSurfer error:\", err);\n    });\n\n    // Load audio file safely\n    try {\n      ws.load(audioUrl);\n    } catch (err) {\n      console.warn(\"WaveSurfer load error:\", err.message);\n    }\n\n    // Cleanup when unmounting or audioUrl changes\n    return () => {\n      isCancelled = true;\n      if (waveSurferRef.current) {\n        // Wait for WaveSurfer to finish any pending work\n        try {\n          waveSurferRef.current.unAll(); // remove listeners first\n          waveSurferRef.current.destroy();\n        } catch (err) {\n          if (err.message !== \"The operation was aborted.\") console.warn(\"WaveSurfer cleanup error:\", err.message);\n        } finally {\n          waveSurferRef.current = null;\n        }\n      }\n    };\n  }, [audioUrl]);\n  useEffect(() => {\n    const ws = waveSurferRef.current;\n    if (!ws) return;\n\n    // Si le parent dit de jouer ET que le son est prêt\n    if (isPlaying && isReady) {\n      ws.play().catch(err => console.warn(\"Erreur lecture:\", err.message));\n    } else {\n      // Sinon on met en pause\n      ws.pause();\n    }\n  }, [isPlaying, isReady]); // Se lance quand le statut change ou que le son est prêt\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100%\",\n      maxWidth: 600,\n      marginTop: 30\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), !isReady && audioUrl && /*#__PURE__*/_jsxDEV(\"p\", {\n      style: {\n        textAlign: \"center\",\n        color: \"#666\"\n      },\n      children: \"Chargement du son...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n_s(Waveform, \"S2OjcEy9jeb1BeuzZnnPS5yhgN4=\");\n_c = Waveform;\nexport default Waveform;\nvar _c;\n$RefreshReg$(_c, \"Waveform\");","map":{"version":3,"names":["React","useEffect","useRef","useState","WaveSurfer","jsxDEV","_jsxDEV","Waveform","audioUrl","isPlaying","_s","containerRef","waveSurferRef","isReady","setIsReady","current","innerHTML","isCancelled","destroy","ws","create","container","waveColor","progressColor","cursorColor","barWidth","barRadius","height","responsive","hideScrollbar","backend","on","err","console","warn","load","message","unAll","play","catch","pause","style","width","maxWidth","marginTop","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","textAlign","color","_c","$RefreshReg$"],"sources":["C:/Users/poula/Desktop/Projet-Site-Web-main/Projet-Site-Web-main/frontend/src/components/Waveform.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\n\nconst Waveform = ({ audioUrl, isPlaying }) => {\n  const containerRef = useRef(null);\n  const waveSurferRef = useRef(null);\n  const [isReady, setIsReady] = useState(false);\n\n  useEffect(() => {\n    if (!containerRef.current || !audioUrl) return;\n    setIsReady(false);\n    containerRef.current.innerHTML = \"\";\n    let isCancelled = false;\n    \n    // Destroy any existing instance before creating a new one\n    if (waveSurferRef.current) {\n        waveSurferRef.current.destroy();\n    }\n\n    // Create new instance\n    const ws = WaveSurfer.create({\n      container: containerRef.current,\n      waveColor: \"violet\",\n      progressColor: \"#9013FE\",\n      cursorColor: \"#fff\",\n      barWidth: 6,\n      barRadius: 3,\n      height: 120,\n      responsive: true,\n      hideScrollbar: true,\n      backend: 'MediaElement',\n    });\n\n    waveSurferRef.current = ws;\n\n    ws.on(\"ready\", async () => {\n      if (isCancelled) return;\n      setIsReady(true);\n    });\n\n    ws.on(\"error\", (err) => {\n      console.warn(\"WaveSurfer error:\", err);\n    });\n\n    // Load audio file safely\n    try {\n      ws.load(audioUrl);\n    } catch (err) {\n      console.warn(\"WaveSurfer load error:\", err.message);\n    }\n\n    // Cleanup when unmounting or audioUrl changes\n    return () => {\n      isCancelled = true;\n\n      if (waveSurferRef.current) {\n        // Wait for WaveSurfer to finish any pending work\n        try {\n          waveSurferRef.current.unAll(); // remove listeners first\n          waveSurferRef.current.destroy();\n        } catch (err) {\n          if (err.message !== \"The operation was aborted.\")\n            console.warn(\"WaveSurfer cleanup error:\", err.message);\n        } finally {\n          waveSurferRef.current = null;\n        }\n      }\n    };\n  }, [audioUrl]);\n\n  useEffect(() => {\n    const ws = waveSurferRef.current;\n    if (!ws) return;\n\n    // Si le parent dit de jouer ET que le son est prêt\n    if (isPlaying && isReady) {\n      ws.play().catch((err) => console.warn(\"Erreur lecture:\", err.message));\n    } else {\n      // Sinon on met en pause\n      ws.pause();\n    }\n  }, [isPlaying, isReady]); // Se lance quand le statut change ou que le son est prêt\n\n  return (\n    <div style={{ width: \"100%\", maxWidth: 600, marginTop: 30 }}>\n      <div ref={containerRef}></div>\n      {!isReady && audioUrl && (\n        <p style={{ textAlign: \"center\", color: \"#666\" }}>\n          Chargement du son...\n        </p>\n      )}\n    </div>\n  );\n};\n\nexport default Waveform;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}